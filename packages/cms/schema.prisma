// This file is automatically generated by Keystone, do not modify it manually.
// Modify your Keystone config when you want to change this.

datasource mysql {
  url               = env("DATABASE_URL")
  shadowDatabaseUrl = env("SHADOW_DATABASE_URL")
  provider          = "mysql"
}

generator client {
  provider = "prisma-client-js"
}

model SystemUser {
  id                         Int            @id @default(autoincrement())
  name                       String         @default("")
  email                      String         @unique @default("")
  password                   String
  role                       String
  createdAt                  DateTime?      @default(now())
  updatedAt                  DateTime?      @updatedAt
  from_ImportRecord_importer ImportRecord[] @relation("ImportRecord_importer")
}

model Photo {
  id                    Int          @id @default(autoincrement())
  name                  String       @default("")
  imageFile_id          String?
  imageFile_filesize    Int?
  imageFile_width       Int?
  imageFile_height      Int?
  imageFile_extension   String?
  createdAt             DateTime?    @default(now())
  updatedAt             DateTime?    @updatedAt
  from_Legislator_image Legislator[] @relation("Legislator_image")
  from_Party_image      Party[]      @relation("Party_image")

  @@index([name])
}

model Selected {
  id           Int         @id @default(autoincrement())
  legislator   Legislator? @relation("Selected_legislator", fields: [legislatorId], references: [id])
  legislatorId Int?        @map("legislator")
  topic        Topic?      @relation("Selected_topic", fields: [topicId], references: [id])
  topicId      Int?        @map("topic")
  order        Int
  createdAt    DateTime?   @default(now())
  updatedAt    DateTime?   @updatedAt

  @@index([legislatorId])
  @@index([topicId])
}

model Speech {
  id                          Int                        @id @default(autoincrement())
  legislativeMeeting          LegislativeMeeting?        @relation("Speech_legislativeMeeting", fields: [legislativeMeetingId], references: [id])
  legislativeMeetingId        Int?                       @map("legislativeMeeting")
  legislativeMeetingSession   LegislativeMeetingSession? @relation("Speech_legislativeMeetingSession", fields: [legislativeMeetingSessionId], references: [id])
  legislativeMeetingSessionId Int?                       @map("legislativeMeetingSession")
  legislativeYuanMember       LegislativeYuanMember?     @relation("Speech_legislativeYuanMember", fields: [legislativeYuanMemberId], references: [id])
  legislativeYuanMemberId     Int?                       @map("legislativeYuanMember")
  date                        DateTime                   @mysql.Date
  title                       String                     @default("")
  slug                        String                     @unique @default("")
  summary                     Json?
  content                     Json?
  attendee                    String                     @default("")
  ivodLink                    String                     @default("")
  ivodStartTime               String                     @default("")
  ivodEndTime                 String                     @default("")
  topics                      Topic[]                    @relation("Speech_topics")
  createdAt                   DateTime?                  @default(now())
  updatedAt                   DateTime?                  @updatedAt

  @@index([legislativeMeetingId])
  @@index([legislativeMeetingSessionId])
  @@index([legislativeYuanMemberId])
  @@index([date])
  @@index([title])
  @@index([updatedAt])
}

model Topic {
  id                        Int        @id @default(autoincrement())
  title                     String     @default("")
  slug                      String     @unique @default("")
  speeches                  Speech[]   @relation("Speech_topics")
  relatedTopics             Topic[]    @relation("Topic_referencedByTopics")
  referencedByTopics        Topic[]    @relation("Topic_referencedByTopics")
  relatedTwreporterArticles Json?      @default("[]")
  createdAt                 DateTime?  @default(now())
  updatedAt                 DateTime?  @updatedAt
  from_Selected_topic       Selected[] @relation("Selected_topic")

  @@index([title])
}

model Legislator {
  id                                    Int                     @id @default(autoincrement())
  name                                  String                  @default("")
  slug                                  String                  @unique @default("")
  image                                 Photo?                  @relation("Legislator_image", fields: [imageId], references: [id])
  imageId                               Int?                    @map("image")
  imageLink                             String                  @default("")
  externalLink                          String                  @default("")
  meetingTermCount                      Int?
  meetingTermCountInfo                  String                  @default("")
  createdAt                             DateTime?               @default(now())
  updatedAt                             DateTime?               @updatedAt
  from_Selected_legislator              Selected[]              @relation("Selected_legislator")
  from_LegislativeYuanMember_legislator LegislativeYuanMember[] @relation("LegislativeYuanMember_legislator")

  @@index([imageId])
}

model LegislativeYuanMember {
  id                   Int                 @id @default(autoincrement())
  legislator           Legislator?         @relation("LegislativeYuanMember_legislator", fields: [legislatorId], references: [id])
  legislatorId         Int?                @map("legislator")
  labelForCMS          String              @default("")
  party                Party?              @relation("LegislativeYuanMember_party", fields: [partyId], references: [id])
  partyId              Int?                @map("party")
  legislativeMeeting   LegislativeMeeting? @relation("LegislativeYuanMember_legislativeMeeting", fields: [legislativeMeetingId], references: [id])
  legislativeMeetingId Int?                @map("legislativeMeeting")
  speeches             Speech[]            @relation("Speech_legislativeYuanMember")
  sessionAndCommittee  CommitteeMember[]   @relation("CommitteeMember_legislativeYuanMember")
  type                 String
  constituency         String?
  city                 String?
  tooltip              String              @default("")
  note                 String              @default("")
  proposalSuccessCount Int?
  isActive             Boolean             @default(true)
  createdAt            DateTime?           @default(now())
  updatedAt            DateTime?           @updatedAt

  @@index([legislatorId])
  @@index([partyId])
  @@index([legislativeMeetingId])
}

model Party {
  id                               Int                     @id @default(autoincrement())
  name                             String                  @default("")
  slug                             String                  @unique @default("")
  image                            Photo?                  @relation("Party_image", fields: [imageId], references: [id])
  imageId                          Int?                    @map("image")
  imageLink                        String                  @default("")
  createdAt                        DateTime?               @default(now())
  updatedAt                        DateTime?               @updatedAt
  from_LegislativeYuanMember_party LegislativeYuanMember[] @relation("LegislativeYuanMember_party")

  @@index([imageId])
}

model LegislativeMeeting {
  id                                                Int                         @id @default(autoincrement())
  term                                              Int                         @unique
  startTime                                         DateTime                    @mysql.Date
  endTime                                           DateTime                    @mysql.Date
  committees                                        Committee[]                 @relation("LegislativeMeeting_committees")
  createdAt                                         DateTime?                   @default(now())
  updatedAt                                         DateTime?                   @updatedAt
  from_Speech_legislativeMeeting                    Speech[]                    @relation("Speech_legislativeMeeting")
  from_LegislativeYuanMember_legislativeMeeting     LegislativeYuanMember[]     @relation("LegislativeYuanMember_legislativeMeeting")
  from_LegislativeMeetingSession_legislativeMeeting LegislativeMeetingSession[] @relation("LegislativeMeetingSession_legislativeMeeting")
}

model LegislativeMeetingSession {
  id                                             Int                 @id @default(autoincrement())
  legislativeMeeting                             LegislativeMeeting? @relation("LegislativeMeetingSession_legislativeMeeting", fields: [legislativeMeetingId], references: [id])
  legislativeMeetingId                           Int?                @map("legislativeMeeting")
  labelForCMS                                    String              @default("")
  term                                           Int
  startTime                                      DateTime            @mysql.Date
  endTime                                        DateTime            @mysql.Date
  createdAt                                      DateTime?           @default(now())
  updatedAt                                      DateTime?           @updatedAt
  from_Speech_legislativeMeetingSession          Speech[]            @relation("Speech_legislativeMeetingSession")
  from_CommitteeMember_legislativeMeetingSession CommitteeMember[]   @relation("CommitteeMember_legislativeMeetingSession")

  @@index([legislativeMeetingId])
}

model Committee {
  id                                 Int                  @id @default(autoincrement())
  name                               String               @default("")
  slug                               String               @unique @default("")
  type                               String?
  createdAt                          DateTime?            @default(now())
  updatedAt                          DateTime?            @updatedAt
  from_LegislativeMeeting_committees LegislativeMeeting[] @relation("LegislativeMeeting_committees")
  from_CommitteeMember_committee     CommitteeMember[]    @relation("CommitteeMember_committee")

  @@index([name])
  @@index([type])
}

model CommitteeMember {
  id                          Int                        @id @default(autoincrement())
  legislativeMeetingSession   LegislativeMeetingSession? @relation("CommitteeMember_legislativeMeetingSession", fields: [legislativeMeetingSessionId], references: [id])
  legislativeMeetingSessionId Int?                       @map("legislativeMeetingSession")
  legislativeYuanMember       LegislativeYuanMember?     @relation("CommitteeMember_legislativeYuanMember", fields: [legislativeYuanMemberId], references: [id])
  legislativeYuanMemberId     Int?                       @map("legislativeYuanMember")
  committee                   Committee[]                @relation("CommitteeMember_committee")
  createdAt                   DateTime?                  @default(now())
  updatedAt                   DateTime?                  @updatedAt

  @@index([legislativeMeetingSessionId])
  @@index([legislativeYuanMemberId])
}

model ImportRecord {
  id                  Int         @id @default(autoincrement())
  recordName          String      @default("")
  uploadData_listName String
  uploadData_csvData  Json
  recordCount         Int?
  importer            SystemUser? @relation("ImportRecord_importer", fields: [importerId], references: [id])
  importerId          Int?        @map("importer")
  createdAt           DateTime?   @default(now())
  updatedAt           DateTime?   @updatedAt

  @@index([importerId])
}
